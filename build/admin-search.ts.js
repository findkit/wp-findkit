(()=>{"use strict";var t=class{constructor(t){this.i=new Map,this.a=t}on(t,e){let i=this.i.get(t)||new Set;return this.i.set(t,i),i.add(e),()=>{this.off(t,e)}}once(t,e){let i=this.on(t,(t=>{i(),e(t,this.a)}));return i}off(t,e){this.i.get(t)?.delete(e)}dispose(){this.i.clear()}emit(t,e){let i=this.i.get(t);if(typeof window<"u"){let i=new CustomEvent("findkituievent",{detail:{eventName:t,data:e,instance:this.a}});window.dispatchEvent(i)}if(i)for(let t of i)t(e,this.a)}},e=class{constructor(t){this.s=new Set,this.u=!1,this.create=t=>{if(this.u)return()=>{};let e=t();return this.s.add(e),()=>{this.s.has(e)&&(this.s.delete(e),e())}},this.child=t=>{let i=new e((()=>{this.s.delete(i.dispose),t?.()}));return this.disposed?i.dispose():this.create((()=>i.dispose)),i},this.dispose=()=>{this.u=!0;let t=Array.from(this.s);this.s.clear(),t.forEach((t=>t())),this.d?.()},this.d=t}get disposed(){return this.u}get size(){return this.s.size}};function i(t,e,i,s){return t.addEventListener(e,i,s),()=>{t.removeEventListener(e,i)}}var s=()=>document;function n(t){let e="https://cdn.findkit.com/ui/v0.17.0";return t.endsWith(".js")?`${e}/esm/${t}`:`${e}/${t}`}var r=!1;function o(t,...e){let i="";return t.forEach(((t,s)=>{i+=t+(e[s]||"")})),i}function a(t,e,n){let r=t=>{let i=(Array.isArray(t)||t instanceof NodeList?Array.from(t):[t]).filter((t=>t instanceof e));0===i.length?console.error("[findkit] select(): No elements found for selector",t):n(i[0],...i.slice(1))};"string"==typeof t?function(t){/interactive|complete/.test(s().readyState)?t():i(s(),"DOMContentLoaded",(()=>{t()}),{once:!0})}((()=>{r(s().querySelectorAll(t))})):r(t)}var l={css:o};function d(t){return(...e)=>{let i=l[t];if(!i)throw new Error(`[findkit] Implementation for "${t}" not loaded yet!`);return i(...e)}}var h={},c=d("html");function u(t){let e={};return new Proxy(t,{get:(t,i)=>(e[i]||(e[i]=(...e)=>{let s=t?.[i];if(!s)throw new Error(`[findkit] Cannot use '${String(i)}': Implementation not loaded yet!`);return s.apply(t,e)}),e[i])})}d("h"),d("useCustomRouterData");var p=u(h);async function f(t){let e="string"==typeof t?t:t.href;if(!e)return;let n=s().createElement("link");n.rel="preload",n.as="style",n.href=e;let r=new Promise((t=>{setTimeout(t,2e3),i(n,"load",t,{once:!0}),i(n,"error",(()=>{console.error(`[findkit] Failed to load stylesheet ${e}`),t({})}),{once:!0})}));s().head?.appendChild(n),await r,n.remove()}d("useTerms"),d("useTotal"),d("useResults"),d("useParams"),d("useGroups"),d("useTotalHitCount"),d("useLoading"),d("useInput"),d("useLang");const m=new class{constructor(i){this.c=!1,this.o=new e,this.t=function(){let e,i=new t("lazyValue");return Object.assign((t=>{void 0!==e?t(e):i.once("value",(i=>{e=i.value,t(e)}))}),{get:()=>e,provide:t=>{if(void 0!==e)throw new Error("Value already provided");e=t,i.emit("value",{value:t})}})}(),this.close=this.r("close"),this.setUIStrings=this.r("setUIStrings"),this.setLang=this.r("setLang"),this.addTranslation=this.r("addTranslation"),this.updateGroups=this.r("updateGroups"),this.setCustomRouterData=this.r("setCustomRouterData"),this.updateParams=this.r("updateParams"),this.preload=async()=>{await this.l(),await new Promise((t=>{this.t(t)}))},this.f=t=>{t.target instanceof HTMLAnchorElement&&(t.ctrlKey||t.shiftKey||t.metaKey||2===t.which)||(t.preventDefault(),this.open())};let s=i.instanceId??"fdk";this.e=i,this.n=new t(this);let n={instanceId:s,utils:u(l),preact:p,options:{...i,instanceId:s}};this.n.emit("init",n),this.e=n.options,this.emitLoadingEvents(),(this.m()||!1===i.modal||"boolean"!=typeof i.modal&&i.container)&&this.open()}emitLoadingEvents(){let t,e=this.n,i=0,s=!1,n=()=>{i++,!t&&(t=setTimeout((()=>{t=void 0,s||(s=!0,e.emit("loading",{}),this.t((t=>{t.state.loading=s})))}),this.e.loadingThrottle??1e3))},r=()=>{setTimeout((()=>{i--,!(i>0)&&(clearTimeout(t),t=void 0,s&&(s=!1,e.emit("loading-done",{}),this.t((t=>{t.state.loading=s}))))}),10)};e.on("fetch",n),e.on("fetch-done",r),e.once("request-open",(t=>{t.preloaded||(n(),e.once("loaded",r))}))}get groups(){return this.t.get()?.getGroups()??this.e.groups??[]}get params(){return this.t.get()?.getParams()??this.e.params??{tagQuery:[]}}on(t,e){return this.n.on(t,e)}once(t,e){return this.n.once(t,e)}terms(){return this.t.get()?.state.usedTerms??""}status(){return this.t.get()?.state.status??"waiting"}dispose(){this.close(),this.o.dispose()}r(t){return(...e)=>{this.t((i=>{i[t](...e)}))}}get id(){return this.e.instanceId??"fdk"}m(){if(typeof window>"u")return!1;let t=location.search;return"hash"===this.e.router&&(t=location.hash.slice(1)),new URLSearchParams(t).has(this.id+"_q")}p(){let t=[];return this.e.load||t.push({href:n("styles.css"),layer:"findkit.core"}),this.e.styleSheet&&t.push({href:this.e.styleSheet,layer:"findkit.user"}),t}open(t){this.n.emit("request-open",{preloaded:!!this.t.get()}),function(){if(r)return;r=!0;let t=s().createElement("link");t.rel="preconnect",t.href="https://search.findkit.com",s().head?.appendChild(t)}(),this.l(),this.t((e=>{e.open(t)}))}search(t){this.open(t)}async h(){let t,e=Promise.all(this.p().map(f));return t=this.e.load?this.e.load():async function(t,e){let i=window,n=`${t}_promise`;if(i[n])return i[n];let r=new Promise(((i,n)=>{let r=s().createElement("script");r.type="module";let o=setTimeout((()=>{n(new Error(`[findkit] Timeout loading script ${e} with ${t}`))}),1e4);Object.assign(window,{[t](e){delete window[t],clearTimeout(o),r.remove(),i(e)}}),r.src=e,s().head?.appendChild(r)}));return i[n]=r,r}("FINDKIT_LOADED_0.17.0",n("implementation.js")).then((t=>({js:t}))),await e,await t}async l(){if(this.c||this.t.get())return;this.c=!0;let t=await this.h();if(typeof location<"u"){let t=new URLSearchParams(location.search),e=Number(t.get("__fdk_simulate_slow_load"));e&&await new Promise((t=>setTimeout(t,e)))}Object.assign(l,t.js),Object.assign(h,t.js.preact);let{styleSheet:e,load:i,css:s,...n}=this.e,r=this.p();t.css&&r.push({css:t.css,layer:"findkit.core"}),s&&r.push({css:s,layer:"findkit.user"});let o=e=>{this.o.create((()=>{let{engine:i,host:s}=t.js._init({...n,container:e,layeredCSS:r,instanceId:this.id,events:this.n,searchEndpoint:this.e.searchEndpoint});return this.c=!0,this.container=s,this.t.provide(i),this.n.emit("loaded",{container:s}),i.start(),i.dispose}))};this.e.container?a(this.e.container,Element,o):o()}trapFocus(t){let e=this.o.child();return a(t,HTMLElement,((...t)=>{this.t((i=>{e.create((()=>i.trapFocus(t)))}))})),e.dispose}openFrom(t){let e=this.o.child();return a(t,HTMLElement,((...t)=>{for(let s of t)e.create((()=>i(s,"click",this.f))),e.create((()=>i(s,"keydown",(t=>{t.target instanceof HTMLElement&&"Enter"===t.key&&"button"===t.target.role&&(t.preventDefault(),this.open())})))),e.create((()=>i(s,"mouseover",this.preload,{once:!0,passive:!0})));t.some((t=>t.dataset.clicked))&&this.open()})),e.dispose}bindInput(t){let e=this.o.child();return a(t,HTMLInputElement,((...t)=>{for(let s of t)e.create((()=>i(s,"focus",this.preload))),this.t((t=>{e.create((()=>t.bindInput(s)))}))})),e.dispose}}({publicToken:FINDKIT_ADMIN_SEARCH.publicToken,instanceId:"findkit_wp_admin",css:o`
		:host {
			--findkit--brand-color: #2271b1;
		}

		.findkit--magnifying-glass-lightning {
			visibility: visible;
		}

		a {
			color: var(--findkit--brand-color);
		}

		.findkit--wp-admin-link {
			display: block;
			margin-top: 10px;
			font-weight: 800;
		}
	`,slots:{Header:t=>c`
                ${t.children}
                ${FINDKIT_ADMIN_SEARCH.settingsURL?c`
                        <a href="${FINDKIT_ADMIN_SEARCH.settingsURL}"
                            class="findkit--wp-admin-link findkit--hit-url findkit--link">
                            Open Findkit WordPress Settings
                        </a>`:null}
            `,Hit(t){let e=t.hit.tags.includes("wordpress");if(!e){const i=window.location.host;e=t.hit.tags.some((t=>t.startsWith(`domain/${i}`)))}if(!e)return t.children;const i=new URL(window.location.toString());return i.search="",i.searchParams.set("findkit_edit_redirect",t.hit.url),c`
                ${t.children}
                <a href="${i.toString()}"
                    class="findkit--wp-admin-link findkit--hit-url findkit--link">
                    Edit in WP Admin
                </a>
            `}}});function g(t){return!!(t.target instanceof HTMLElement&&(t.target.classList.contains("findkit-admin-search")||t.target.closest(".findkit-adminbar-search")))}m.on("loading",(()=>{const t=document.querySelector(".findkit-adminbar-search a");t instanceof HTMLElement&&(t.dataset.origContent=t.innerHTML,t.innerHTML="Loading...")})),m.on("loading-done",(()=>{const t=document.querySelector(".findkit-adminbar-search a");t instanceof HTMLElement&&t.dataset.origContent&&(t.innerHTML=t.dataset.origContent,delete t.dataset.origContent)})),document.addEventListener("click",(t=>{g(t)&&(t.preventDefault(),m.open())})),document.addEventListener("mouseover",(t=>{g(t)&&m.preload()}))})();