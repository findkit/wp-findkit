(()=>{"use strict";window.React;const e=window.wp.blocks,t=window.wp.blockEditor,i=window.wp.components,n=JSON.parse('{"$schema":"https://json.schemastore.org/block.json","apiVersion":3,"name":"findkit/search-modal","category":"widgets","attributes":{"publicToken":{"type":"string"},"instanceId":{"type":"string"},"colorSlug":{"type":"string"},"categories":{"type":"string"},"tags":{"type":"string"},"postTypes":{"type":"string"},"domains":{"type":"string"},"rawTags":{"type":"string"}},"providesContext":{"findkit/publicToken":"publicToken","findkit/instanceId":"instanceId"},"version":"0.1.0","title":"Findkit Search Modal","icon":"search","description":"Open Findkit Search Modal from a button, image or the search form.","supports":{},"textdomain":"findkit","render":"file:render.php","viewScript":"findkit-search-blocks-view","style":"findkit-search-blocks-view","editorScript":"findkit-search-blocks-editor","editorStyle":["findkit-search-blocks-view","findkit-search-blocks-editor"]}'),s=JSON.parse('{"$schema":"https://json.schemastore.org/block.json","apiVersion":3,"name":"findkit/search-embed","category":"widgets","attributes":{"publicToken":{"type":"string"},"instanceId":{"type":"string"},"colorSlug":{"type":"string"},"inputPlaceholder":{"type":"string"},"categories":{"type":"string"},"tags":{"type":"string"},"postTypes":{"type":"string"},"domains":{"type":"string"},"rawTags":{"type":"string"}},"providesContext":{"findkit/publicToken":"publicToken","findkit/instanceId":"instanceId"},"version":"0.1.0","title":"Findkit Search Embed","icon":"search","description":"Embed Findkit Search UI into your posts and pages.","supports":{},"render":"file:render.php","textdomain":"findkit","viewScript":"findkit-search-blocks-view","style":"findkit-search-blocks-view","editorScript":"findkit-search-blocks-editor","editorStyle":"findkit-search-blocks-editor"}'),r=JSON.parse('{"$schema":"https://json.schemastore.org/block.json","apiVersion":3,"name":"findkit/search-group","version":"0.1.0","title":"Findkit Search Group","icon":"search","description":"Add as an inner block to the Findkit Search Modal or as a Findkit Search Embed block to group search results by custom filters","category":"widgets","supports":{},"textdomain":"findkit","parent":["findkit/search-modal","findkit/search-embed"],"attributes":{"groupTitle":{"type":"string"},"categories":{"type":"string"},"tags":{"type":"string"},"postTypes":{"type":"string"},"domains":{"type":"string"},"rawTags":{"type":"string"}},"usesContext":["findkit/publicToken"],"viewScript":"findkit-search-blocks-view","render":"file:render.php","style":"findkit-search-blocks-view","editorScript":"findkit-search-blocks-editor","editorStyle":"findkit-search-blocks-editor"}'),o=window.wp.data;function l(e){var t;return null!==(t=(0,o.useSelect)(t=>t("core").getEntityRecords("taxonomy",e),[e]))&&void 0!==t?t:[]}function a(e){return(0,o.useSelect)(t=>t("core/block-editor").getBlock(e).innerBlocks,[e])}const c=window.ReactJSXRuntime;function d(e){const n=function(){const[e]=(0,t.useSettings)("color.palette");return null!=e?e:[]}(),s=n.find(t=>t.slug===e.value)?.color;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("label",{className:"findkit-label",children:e.label}),(0,c.jsx)("p",{className:"findkit-help",children:e.help}),(0,c.jsx)(i.ColorPalette,{value:s,colors:n,disableCustomColors:!0,onChange:t=>{const i=n.find(e=>e.color===t);e.onChange(i?.slug)}})]})}const p=["core/button","core/image","core/search"];function h(e){var t;return null!==(t=e?.split(",").filter(Boolean))&&void 0!==t?t:[]}function u(e){const t=l("category"),n=l("post_tag"),s=(null!==(r=(0,o.useSelect)(e=>e("core").getPostTypes(),[]))&&void 0!==r?r:[]).filter(e=>e.viewable&&e.supports.editor);var r;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(i.PanelRow,{children:(0,c.jsx)("p",{className:"findkit-search-group-panel-title",children:"Filter down the search results"})}),(0,c.jsx)(i.PanelRow,{children:(0,c.jsx)(i.SelectControl,{multiple:!0,label:"Post types",help:"Show search results only form the selected post types",value:h(e.attributes.postTypes),onChange:t=>{e.setAttributes({postTypes:t.join(",")})},options:s.map(e=>({value:e.slug,label:e.name})),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})}),(0,c.jsx)(i.PanelRow,{children:(0,c.jsx)(i.SelectControl,{multiple:!0,label:"Categories",help:"Show search results only from the selected categories",value:h(e.attributes.categories),onChange:t=>{e.setAttributes({categories:t.join(",")})},options:t.map(e=>({value:e.slug,label:e.name})),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})}),n.length>0&&(0,c.jsx)(i.PanelRow,{children:(0,c.jsx)(i.SelectControl,{multiple:!0,label:"WordPress Post Tags",help:"Show search results only from the selected tags",value:h(e.attributes.tags),onChange:t=>{e.setAttributes({tags:t.join(",")})},options:n.map(e=>({value:e.slug,label:e.name})),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})}),(0,c.jsx)(i.PanelRow,{children:(0,c.jsx)(i.TextareaControl,{label:"Domains",help:"Limit search results to these domains. One per line.",value:e.attributes.domains||"",onChange:t=>{e.setAttributes({domains:t})},__nextHasNoMarginBottom:!0})}),(0,c.jsx)(i.PanelRow,{children:(0,c.jsx)(i.TextareaControl,{label:"Findkit Tags",help:(0,c.jsxs)(c.Fragment,{children:["Limit search results to these these Findkit Tags. One per line.",e.publicToken&&(0,c.jsxs)(c.Fragment,{children:[" ","See available tags from the"," ",(0,c.jsx)("a",{href:`https://hub.findkit.com/p/${e.publicToken}?view=inspect`,target:"_blank",children:"Findkit Hub"})," ","Inspect view."]})]}),value:e.attributes.rawTags||"",onChange:t=>{e.setAttributes({rawTags:t})},__nextHasNoMarginBottom:!0})})]})}function g(e){return(0,c.jsxs)(i.Panel,{children:[(0,c.jsxs)(i.PanelBody,{title:"Settings",initialOpen:!0,children:[(0,c.jsx)(i.PanelRow,{children:(0,c.jsx)(i.TextControl,{value:e.attributes.publicToken||"",onChange:t=>{e.setAttributes({publicToken:t})},label:"Findkit Public Token",help:"Get public token from the Findkit Hub",__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})}),(0,c.jsx)(i.PanelRow,{children:(0,c.jsx)(i.TextControl,{value:e.attributes.instanceId||"",onChange:t=>{e.setAttributes({instanceId:t})},label:"FindkitUI Instance ID",help:(0,c.jsxs)(c.Fragment,{children:["Must be unique for each block on a page. See the"," ",(0,c.jsx)("a",{href:"https://findk.it/instanceid",children:"docs"}),"."]}),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})}),(0,c.jsx)(i.PanelRow,{className:"findkit-color-picker",children:(0,c.jsx)(d,{label:"Brand Color",help:"Select brand color for the search UI",value:e.attributes.colorSlug,onChange:t=>{e.setAttributes({colorSlug:t})}})}),e.children]}),(0,c.jsx)(i.PanelBody,{title:"Search Filters",initialOpen:!1,children:(0,c.jsx)(u,{publicToken:e.attributes.publicToken,initialOpen:!1,...e})})]})}(0,e.registerBlockType)(n,{edit:function(e){const i=(0,t.useBlockProps)(),n=a(e.clientId).filter(e=>"findkit/search-group"!==e.name).length>0;return(0,c.jsxs)("div",{...i,children:[(0,c.jsx)(t.InspectorControls,{children:(0,c.jsx)(g,{...e})}),n?null:(0,c.jsxs)("div",{className:"findkit-no-modal-inner-blocks",children:[(0,c.jsx)("b",{children:"Search Modal"}),(0,c.jsx)("p",{children:"Add an inner block"})]}),(0,c.jsx)(t.InnerBlocks,{allowedBlocks:p})]})},save:()=>(0,c.jsx)(t.InnerBlocks.Content,{})}),(0,e.registerBlockType)(r,{edit:function(e){const n=(0,t.useBlockProps)(),s=e.context["findkit/publicToken"];return(0,c.jsxs)("div",{...n,children:[(0,c.jsx)("div",{className:"findkit-search-group-title",children:e.attributes.groupTitle||"Untitled"}),(0,c.jsx)("div",{className:"findkit-search-group-help",children:"Search result group. Edit the search filters in the block inspector. Remove all groups to show the results in a single search."}),(0,c.jsx)(t.InspectorControls,{children:(0,c.jsx)(i.Panel,{children:(0,c.jsxs)(i.PanelBody,{title:"Settings",initialOpen:!0,children:[(0,c.jsx)(i.PanelRow,{children:(0,c.jsx)(i.TextControl,{label:"Group Title",value:e.attributes.groupTitle||"",onChange:t=>{e.setAttributes({groupTitle:t})},__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})}),(0,c.jsx)(u,{publicToken:null!=s?s:FINDKIT_SEARCH_BLOCK.publicToken,...e,initialOpen:!0})]})})})]})},save:()=>(0,c.jsx)(t.InnerBlocks.Content,{})}),(0,e.registerBlockType)(s,{edit:function(n){const s=(0,t.useBlockProps)(),{insertBlock:r}=(0,o.useDispatch)(t.store),l=a(n.clientId);return(0,c.jsxs)("div",{...s,children:[(0,c.jsx)(t.InspectorControls,{children:(0,c.jsx)(g,{...n,children:(0,c.jsx)(i.PanelRow,{children:(0,c.jsx)(i.TextControl,{value:n.attributes.inputPlaceholder||"",placeholder:"Search...",onChange:e=>{n.setAttributes({inputPlaceholder:e})},label:"Input placeholder",help:"Placeholder text on the search input before user types anything",__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})})})}),(0,c.jsx)("div",{className:"wp-findkit-input-wrap",children:(0,c.jsx)("input",{className:"wp-findkit-search-input",type:"search",placeholder:n.attributes.inputPlaceholder||"Search...",disabled:!0})}),0===l.length?(0,c.jsxs)("div",{className:"findkit-no-embed-inner-blocks",children:[(0,c.jsx)("b",{children:"Search Results"}),(0,c.jsx)("p",{children:"Search results will be rendered here on the frontend."}),(0,c.jsx)("p",{children:'Filter results by using the "Search Filter" options in the block inspector. Group the results by adding inner Findkit Group blocks.'}),(0,c.jsx)(i.Button,{variant:"secondary",onClick:()=>{const t=(0,e.createBlock)("findkit/search-group",{postTypes:"post",groupTitle:"Posts"}),i=(0,e.createBlock)("findkit/search-group",{postTypes:"page",groupTitle:"Pages"});r(i,0,n.clientId),r(t,0,n.clientId)},children:"Add example groups"})]}):null,(0,c.jsx)(t.InnerBlocks,{allowedBlocks:["findkit/search-group"]})]})},save:()=>(0,c.jsx)(t.InnerBlocks.Content,{})})})();